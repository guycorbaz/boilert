import { PageStyle } from "styles.slint";
import { Button, VerticalBox, HorizontalBox } from "std-widgets.slint";
import { Sensor } from "sensot.slint";

export struct SensorData {
    name: string,
    value: float,
    history_path: string,
}

export component StatsPage {
    // Back button
    callback back();

    in property <[SensorData]> sensors;

    Rectangle {
        background: black;
        border-color: black;
        border-width: 1px;
        x: 1px * PageStyle.ext_padding;
        y: 1px * PageStyle.ext_padding;
        width: parent.width - 1px * PageStyle.ext_padding;
        height: parent.height - 0px * PageStyle.ext_padding;

        // Page title
        Text {
            y: 0;
            text: "Statistiques de tempÃ©rature";
            color: white;
            font-size: 20pt;
            font-weight: 800;
        }

        Rectangle {
            y: 60px;
            background: black;

            // Container for the dynamic sensor list.
            // We use a combination of VerticalBox and HorizontalBox to achieve a 
            // two-column layout, as Slint's GridLayout doesn't currently support 
            // dynamic 'for' loops for rows and columns.
            VerticalBox {
                spacing: 20px;
                padding: 0px;
                // Row 1: Sensors 1 and 2
                if root.sensors.length > 0: HorizontalBox {
                    spacing: 20px;
                    Sensor {
                        name: root.sensors[0].name;
                        value: root.sensors[0].value;
                        history_path: root.sensors[0].history_path;
                    }

                    if root.sensors.length > 1: Sensor {
                        name: root.sensors[1].name;
                        value: root.sensors[1].value;
                        history_path: root.sensors[1].history_path;
                    }
                }
                // Row 2: Sensors 3 and 4
                if root.sensors.length > 2: HorizontalBox {
                    spacing: 20px;
                    Sensor {
                        name: root.sensors[2].name;
                        value: root.sensors[2].value;
                        history_path: root.sensors[2].history_path;
                    }

                    if root.sensors.length > 3: Sensor {
                        name: root.sensors[3].name;
                        value: root.sensors[3].value;
                        history_path: root.sensors[3].history_path;
                    }
                }
                // Row 3: Sensors 5 and 6
                if root.sensors.length > 4: HorizontalBox {
                    spacing: 20px;
                    Sensor {
                        name: root.sensors[4].name;
                        value: root.sensors[4].value;
                        history_path: root.sensors[4].history_path;
                    }

                    if root.sensors.length > 5: Sensor {
                        name: root.sensors[5].name;
                        value: root.sensors[5].value;
                        history_path: root.sensors[5].history_path;
                    }
                }
            }
        }
       // Back button
        Button {
            text: "Retour";
            width: 120px;
            height: 40px;
            x: parent.width - self.width - 20px;
            y: parent.height - self.height - 20px;
            clicked => {
                root.back();
            }
        }
    }
}
