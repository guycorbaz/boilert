import { Button } from "std-widgets.slint";
import { DashboardPage, StatsPage, SensorData } from "pages.slint";
import { PageStyle } from "styles.slint";

// Main application window that coordinates pages and data
export component AppWindow inherits Window {
    width: 800px;
    height: 480px;
    background: black;

    // State property to track the active page (0 = Dashboard, 1 = Stats)
    property <int> active-page: 0;
    
    // Global energy data
    in property <float> energy_kwh: 0.0;
    
    // Software version
    in property <string> app-version: "0.0.0";

    // Dynamic sensor model
    in property <[SensorData]> sensors: [
        { name: "S1", value: 0.0, history_path: "" },
        { name: "S2", value: 0.0, history_path: "" },
        { name: "S3", value: 0.0, history_path: "" },
        { name: "S4", value: 0.0, history_path: "" },
        { name: "S5", value: 0.0, history_path: "" },
        { name: "S6", value: 0.0, history_path: "" },
    ];

    // Page: Dashboard
    if (active-page == 0): DashboardPage {
        x: 0px;
        y: 0px;
        width: parent.width - 1px * PageStyle.ext_padding;
        height: parent.height - 1px * PageStyle.ext_padding;
        energy_kwh: root.energy_kwh;
        show-stats => {
            active-page = 1;
        }
    }

    // Page: Stats
    if (active-page == 1): StatsPage {
        x: 0px;
        y: 0px;
        width: parent.width - 1px * PageStyle.ext_padding;
        height: parent.height - 1px * PageStyle.ext_padding;
        sensors: root.sensors;

        back => {
            active-page = 0;
        }
    }

    // Version display at the bottom left
    Text {
        text: "v" + root.app-version;
        color: lightgray;
        font-size: 10px;
        x: 10px;
        y: parent.height - self.height - 5px;
    }
}
